# Set the output file path for saving the deleted file names
$outputFilePath = "C:\Users\com300\Downloads\output.txt"

# Find .c and .cpp files in C:\Users\com300 with no depth limit, excluding C:\Users\com300\.vscode
# Search C:\Users\com300 for .c files without depth limit
Get-ChildItem -Path "C:\Users\com300" -Filter "*.c" -Recurse | Where-Object { $_.FullName -notlike "C:\Users\com300\.vscode*" } | ForEach-Object {
    # Save the name of the deleted file to the output.txt file
    $_.FullName | Out-File -FilePath $outputFilePath -Append

    # Delete the file
    Remove-Item $_.FullName -Force
}

# Search all other directories for .c files with max depth of 2, excluding C:\Users\com300\.vscode
Get-ChildItem -Path . -Filter "*.c" -Recurse -Depth 2 | Where-Object { $_.FullName -notlike "C:\Users\com300\.vscode*" -and $_.FullName -notlike "C:\Users\com300*" } | ForEach-Object {
    # Save the name of the deleted file to the output.txt file
    $_.FullName | Out-File -FilePath $outputFilePath -Append

    # Delete the file
    Remove-Item $_.FullName -Force
}

# Find .cpp files in C:\Users\com300 with no depth limit, excluding C:\Users\com300\.vscode
# Search C:\Users\com300 for .cpp files without depth limit
Get-ChildItem -Path "C:\Users\com300" -Filter "*.cpp" -Recurse | Where-Object { $_.FullName -notlike "C:\Users\com300\.vscode*" } | ForEach-Object {
    # Save the name of the deleted file to the output.txt file
    $_.FullName | Out-File -FilePath $outputFilePath -Append

    # Delete the file
    Remove-Item $_.FullName -Force
}

# Search all other directories for .cpp files with max depth of 2, excluding C:\Users\com300\.vscode
Get-ChildItem -Path . -Filter "*.cpp" -Recurse -Depth 2 | Where-Object { $_.FullName -notlike "C:\Users\com300\.vscode*" -and $_.FullName -notlike "C:\Users\com300*" } | ForEach-Object {
    # Save the name of the deleted file to the output.txt file
    $_.FullName | Out-File -FilePath $outputFilePath -Append

    # Delete the file
    Remove-Item $_.FullName -Force
}
